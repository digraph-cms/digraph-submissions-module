<div class="submission-window">
    <div class="bodytext">
        {{window.bodyText()|raw}}
    </div>
    {% if window.pending %}
        {# Window hasn't opened yet #}
        <div class="submission-window-status notification notification-notice">
            <strong>Opens: {{window.openHR}}</strong>
            {% if window.close %}
            <br>Deadline: {{window.closeHR}}
            {% endif %}
        </div>
    {% elseif window.ended %}
        {# Window has ended #}
        <div class="submission-window-status ended notification notification-warning">
            <strong>Ended: {{window.closeHR}}</strong>
            {% if window.open %}
            <br>Opened: {{window.openHR}}
            {% endif %}
        </div>
    {% else %}
        {# Window is open #}
        <div class="submission-window-status open notification notification-confirmation">
            <strong>Currently open</strong>
            {% if window.close %}
            <br>Deadline: {{window.closeHR}}
            {% endif %}
        </div>
        {# List existing submissions for current user #}
        {% if window.mySubmissions %}
        <h2>My submissions</h2>
        <ul>
            {% for submission in window.mySubmissions %}
                <li>{{submission.link|raw}}</li>
            {% endfor %}
        </ul>
        {% if window.maxperuser %}
            {% if window.mySubmissions|length %}
                <p>You have used {{window.mySubmissions|length}} of {{window.maxperuser}} allowed submissions per user.</p>
            {% else %}
                <p>Maximum submissions per user: {{window.maxperuser}}.</p>
            {% endif %}
        {% endif %}
        {% else %}
        <h2>Create submission</h2>
        {% endif %}
        {# begin submission link if applicable #}
        {% if window.canSubmit %}
            <a href="{{window.url('submit')}}" class="cta-button">
                Start new submission
            </a>
        {% else %}
            {% if window.maxperuser %}
                {% if window.mySubmissions|length >= window.maxperuser %}
                    <p>You have used {{window.mySubmissions|length}} of {{window.maxperuser}} allowed submissions per user.</p>
                {% endif %}
            {% endif %}
        {% endif %}
    {% endif %}
</div>